{"ast":null,"code":"var _jsxFileName = \"/Users/song-wonjeong/Desktop/react-python/workspace/src/components/Skills/WebcamComponent.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect, useCallback } from 'react';\nimport Webcam from 'react-webcam';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst WebcamApp = _ref => {\n  _s();\n\n  let {\n    selectedObject,\n    objectCount,\n    shootingInterval\n  } = _ref;\n  const webcamRef = useRef(null);\n  useEffect(() => {\n    const constraints = {\n      video: true\n    };\n    navigator.mediaDevices.getUserMedia(constraints).then(stream => {\n      webcamRef.current.stream = stream; // Webcam 컴포넌트의 스트림에 연결\n    }).catch(error => {\n      console.error('Error on accessing webcam: ' + error);\n    });\n  }, []);\n  const saveImageFunction = useCallback(() => {\n    const link = document.createElement('a');\n    link.href = webcamRef.current.getScreenshot();\n    link.download = `capture_${Date.now()}.jpg`;\n    link.click();\n  }, [webcamRef]);\n  const sendImageToServer = useCallback(async () => {\n    if (!webcamRef.current) {\n      return;\n    }\n\n    const imageSrc = webcamRef.current.getScreenshot();\n    const formData = new FormData();\n    formData.append('image', imageSrc);\n\n    try {\n      let response = await fetch(\"http://localhost:8000/detect\", {\n        method: \"POST\",\n        body: formData\n      });\n      let data = await response.json();\n      const detectedObjects = data.detected_objects;\n      const objectOccurrences = detectedObjects.filter(obj => obj === selectedObject).length;\n\n      if (objectOccurrences >= objectCount) {\n        saveImageFunction();\n      }\n    } catch (error) {\n      console.error(\"Error sending image to server: \", error);\n    }\n  }, [selectedObject, objectCount, saveImageFunction]);\n  useEffect(() => {\n    const interval = setInterval(() => {\n      sendImageToServer();\n    }, shootingInterval * 1000);\n    return () => clearInterval(interval);\n  }, [shootingInterval, sendImageToServer]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Webcam, {\n      ref: webcamRef,\n      screenshotFormat: \"image/jpeg\",\n      videoConstraints: {\n        deviceId: 0\n      },\n      width: 500,\n      height: \"auto\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 9\n  }, this);\n};\n\n_s(WebcamApp, \"X6BqDEb7RUGMW2ox8W7PN5tPRWw=\");\n\n_c = WebcamApp;\nexport default WebcamApp;\n\nvar _c;\n\n$RefreshReg$(_c, \"WebcamApp\");","map":{"version":3,"sources":["/Users/song-wonjeong/Desktop/react-python/workspace/src/components/Skills/WebcamComponent.js"],"names":["React","useRef","useEffect","useCallback","Webcam","WebcamApp","selectedObject","objectCount","shootingInterval","webcamRef","constraints","video","navigator","mediaDevices","getUserMedia","then","stream","current","catch","error","console","saveImageFunction","link","document","createElement","href","getScreenshot","download","Date","now","click","sendImageToServer","imageSrc","formData","FormData","append","response","fetch","method","body","data","json","detectedObjects","detected_objects","objectOccurrences","filter","obj","length","interval","setInterval","clearInterval","deviceId"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useCallback } from 'react';\r\nimport Webcam from 'react-webcam';\r\n\r\nconst WebcamApp = ({ selectedObject, objectCount, shootingInterval }) => {\r\n    const webcamRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        const constraints = { video: true };\r\n\r\n        navigator.mediaDevices.getUserMedia(constraints)\r\n        .then((stream) => {\r\n            webcamRef.current.stream = stream; // Webcam 컴포넌트의 스트림에 연결\r\n        }).catch((error) => {\r\n            console.error('Error on accessing webcam: ' + error);\r\n        });\r\n    }, []);\r\n\r\n    const saveImageFunction = useCallback(() => {\r\n        const link = document.createElement('a');\r\n        link.href = webcamRef.current.getScreenshot();\r\n        link.download = `capture_${Date.now()}.jpg`;\r\n        link.click();\r\n    }, [webcamRef]);\r\n\r\n    const sendImageToServer = useCallback(async () => {\r\n        if (!webcamRef.current) {\r\n            return;\r\n        }\r\n\r\n        const imageSrc = webcamRef.current.getScreenshot();\r\n        const formData = new FormData();\r\n        formData.append('image', imageSrc);\r\n\r\n        try {\r\n            let response = await fetch(\"http://localhost:8000/detect\", {\r\n                method: \"POST\",\r\n                body: formData\r\n            });\r\n            let data = await response.json();\r\n            const detectedObjects = data.detected_objects;\r\n            const objectOccurrences = detectedObjects.filter(obj => obj === selectedObject).length;\r\n            if (objectOccurrences >= objectCount) {\r\n                saveImageFunction();\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error sending image to server: \", error);\r\n        }\r\n    }, [selectedObject, objectCount, saveImageFunction]);\r\n\r\n    useEffect(() => {\r\n        const interval = setInterval(() => {\r\n            sendImageToServer();\r\n        }, shootingInterval * 1000);\r\n\r\n        return () => clearInterval(interval);\r\n    }, [shootingInterval, sendImageToServer]);\r\n\r\n    return (\r\n        <div>\r\n            <Webcam\r\n                ref={webcamRef}\r\n                screenshotFormat=\"image/jpeg\"\r\n                videoConstraints={{ deviceId: 0 }}\r\n                width={500}\r\n                height=\"auto\"\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default WebcamApp;\r\n"]},"metadata":{},"sourceType":"module"}